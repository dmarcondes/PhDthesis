#Digits classification MNIST
library(keras)
#wd
setwd("~/GDrive/PESQUISA/Machine Learning/Software/multilayerWOperator/mnist")
#Data
c(c(xtrain, ytrain), c(xtest, ytest)) %<-% dataset_mnist()
for(i in 1:nrow(xtrain))
xtrain[i,,] <- as.numeric(xtrain[i,,] > 0)
set.seed(759)
s <- sample(x = 1:nrow(xtrain),size = floor(0.75*nrow(xtrain)),replace = F)
yval <- ytrain[!(1:nrow(xtrain) %in% s)]
ytrain <- ytrain[(1:nrow(xtrain) %in% s)]
xval <- xtrain[!(1:nrow(xtrain) %in% s),,]
xtrain <- xtrain[(1:nrow(xtrain) %in% s),,]
for(i in 1:nrow(xtrain))
write.table(x = xtrain[i,,],file = paste("train",formatC(x = i,digits = 5,flag = "0"),".txt",sep = ""),sep = " ",row.names = F,col.names = F)
write.table(x = cbind(ytrain),file = "ytrain.txt",sep = " ",row.names = F,col.names = F)
for(i in 1:nrow(xval))
write.table(x = xval[i,,],file = paste("val",formatC(x = i,digits = 5,flag = "0"),".txt",sep = ""),sep = " ",row.names = F,col.names = F)
write.table(x = cbind(yval),file = "yval.txt",sep = " ",row.names = F,col.names = F)
View(xtrain[100,,])
xtrain[100,,]
ytrain[100]
